{%- comment -%}
  GROUND - Main Product Section
  Features: Product images, details, and add to cart
{%- endcomment -%}

<section class="section product-section gradient-bg" data-section-id="{{ section.id }}">
  <div class="container">
    <div class="product-main">
      <!-- Product Gallery -->
      <div class="product-gallery" data-animate>
        <div class="product-gallery-main glass-card">
          {%- if product.featured_image != blank -%}
            <img
              src="{{ product.featured_image | image_url: width: 800 }}"
              alt="{{ product.featured_image.alt | default: product.title }}"
              width="800"
              height="auto"
              id="product-main-image"
            >
          {%- else -%}
            <div class="product-placeholder">
              <svg width="200" height="200" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.5">
                <circle cx="12" cy="12" r="10"></circle>
              </svg>
            </div>
          {%- endif -%}
        </div>

        {%- if product.images.size > 1 -%}
          <div class="product-gallery-thumbs">
            {%- for image in product.images -%}
              <button
                class="product-thumb glass-card{% if forloop.first %} active{% endif %}"
                data-image="{{ image | image_url: width: 800 }}"
              >
                <img
                  src="{{ image | image_url: width: 150 }}"
                  alt="{{ image.alt | default: product.title }}"
                  width="80"
                  height="80"
                >
              </button>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </div>

      <!-- Product Info -->
      <div class="product-info" data-animate>
        <div class="product-info-inner">
          {%- if section.settings.show_vendor and product.vendor -%}
            <p class="overline">{{ product.vendor }}</p>
          {%- endif -%}

          <h1 class="heading-xl">{{ product.title }}</h1>

          <div class="product-price">
            {%- if product.compare_at_price > product.price -%}
              <span class="product-price-compare">{{ product.compare_at_price | money }}</span>
            {%- endif -%}
            <span class="product-price-current">{{ product.price | money }}</span>
          </div>

          {%- if product.description != blank -%}
            <div class="product-description">
              {{ product.description }}
            </div>
          {%- endif -%}

          {%- form 'product', product, class: 'product-form' -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">

            {%- unless product.has_only_default_variant -%}
              {%- for option in product.options_with_values -%}
                <div class="product-option">
                  <label for="Option-{{ option.name | handleize }}">{{ option.name }}</label>
                  <select id="Option-{{ option.name | handleize }}" name="options[{{ option.name }}]">
                    {%- for value in option.values -%}
                      <option value="{{ value }}" {% if option.selected_value == value %}selected{% endif %}>
                        {{ value }}
                      </option>
                    {%- endfor -%}
                  </select>
                </div>
              {%- endfor -%}
            {%- endunless -%}

            <div class="product-quantity">
              <label for="Quantity">Quantity</label>
              <div class="quantity-selector">
                <button type="button" class="quantity-btn" data-action="decrease">-</button>
                <input type="number" id="Quantity" name="quantity" value="1" min="1">
                <button type="button" class="quantity-btn" data-action="increase">+</button>
              </div>
            </div>

            <button
              type="submit"
              class="btn btn-primary btn-lg product-add-btn"
              {% unless product.available %}disabled{% endunless %}
            >
              {%- if product.available -%}
                Add to Cart
              {%- else -%}
                Sold Out
              {%- endif -%}
            </button>

            <div class="product-guarantee">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
              </svg>
              <span>30-day money back guarantee</span>
            </div>
          {%- endform -%}

          <div class="product-features">
            <div class="product-feature-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="1" y="3" width="15" height="13"></rect>
                <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                <circle cx="5.5" cy="18.5" r="2.5"></circle>
                <circle cx="18.5" cy="18.5" r="2.5"></circle>
              </svg>
              <span>Free shipping on 2+ devices</span>
            </div>
            <div class="product-feature-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              </svg>
              <span>1-year warranty</span>
            </div>
            <div class="product-feature-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              <span>Ships within 24 hours</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .product-main {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: start;
  }

  .product-gallery-main {
    padding: 2rem;
    margin-bottom: 1rem;
  }

  .product-gallery-main img {
    width: 100%;
    height: auto;
    border-radius: 12px;
  }

  .product-placeholder {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
  }

  .product-gallery-thumbs {
    display: flex;
    gap: 0.75rem;
  }

  .product-thumb {
    width: 80px;
    height: 80px;
    padding: 0.5rem;
    border: none;
    cursor: pointer;
    opacity: 0.6;
    transition: all 0.2s ease;
  }

  .product-thumb.active,
  .product-thumb:hover {
    opacity: 1;
  }

  .product-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
  }

  .product-info {
    position: sticky;
    top: 120px;
  }

  .product-info-inner {
    max-width: 500px;
  }

  .product-info .overline {
    margin-bottom: 0.5rem;
  }

  .product-info h1 {
    margin-bottom: 1rem;
  }

  .product-price {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .product-price-current {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
  }

  .product-price-compare {
    font-size: 1.25rem;
    color: var(--text-muted);
    text-decoration: line-through;
  }

  .product-description {
    color: var(--text-secondary);
    line-height: 1.7;
    margin-bottom: 2rem;
  }

  .product-option {
    margin-bottom: 1.5rem;
  }

  .product-option label {
    display: block;
    font-weight: 500;
    margin-bottom: 0.5rem;
  }

  .product-option select {
    width: 100%;
    padding: 1rem;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    font-size: 1rem;
    background: var(--white);
  }

  .product-quantity {
    margin-bottom: 1.5rem;
  }

  .product-quantity label {
    display: block;
    font-weight: 500;
    margin-bottom: 0.5rem;
  }

  .quantity-selector {
    display: flex;
    align-items: center;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    width: fit-content;
  }

  .quantity-btn {
    width: 48px;
    height: 48px;
    border: none;
    background: none;
    font-size: 1.25rem;
    cursor: pointer;
    color: var(--text-secondary);
    transition: color 0.2s ease;
  }

  .quantity-btn:hover {
    color: var(--text-primary);
  }

  .quantity-selector input {
    width: 60px;
    height: 48px;
    border: none;
    text-align: center;
    font-size: 1rem;
    font-weight: 500;
  }

  .product-add-btn {
    width: 100%;
    margin-bottom: 1rem;
  }

  .product-guarantee {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-size: 0.9375rem;
    color: var(--text-muted);
    margin-bottom: 2rem;
  }

  .product-guarantee svg {
    color: #10b981;
  }

  .product-features {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .product-feature-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.9375rem;
    color: var(--text-secondary);
  }

  .product-feature-item svg {
    color: var(--accent-primary);
  }

  @media (max-width: 1024px) {
    .product-main {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .product-info {
      position: static;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Image gallery
    const thumbs = document.querySelectorAll('.product-thumb');
    const mainImage = document.getElementById('product-main-image');

    thumbs.forEach(thumb => {
      thumb.addEventListener('click', () => {
        thumbs.forEach(t => t.classList.remove('active'));
        thumb.classList.add('active');
        if (mainImage) {
          mainImage.src = thumb.dataset.image;
        }
      });
    });

    // Quantity selector
    const quantityInput = document.querySelector('.quantity-selector input');
    const decreaseBtn = document.querySelector('[data-action="decrease"]');
    const increaseBtn = document.querySelector('[data-action="increase"]');

    if (quantityInput && decreaseBtn && increaseBtn) {
      decreaseBtn.addEventListener('click', () => {
        const value = parseInt(quantityInput.value);
        if (value > 1) {
          quantityInput.value = value - 1;
        }
      });

      increaseBtn.addEventListener('click', () => {
        const value = parseInt(quantityInput.value);
        quantityInput.value = value + 1;
      });
    }
  });
</script>

{% schema %}
{
  "name": "Product Main",
  "tag": "section",
  "class": "product-main-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show Vendor",
      "default": false
    }
  ]
}
{% endschema %}
