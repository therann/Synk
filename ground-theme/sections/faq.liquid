{%- comment -%}
  GROUND - FAQ Section
  Features: Accordion-style FAQ with glass cards
{%- endcomment -%}

<section class="section gradient-bg" data-section-id="{{ section.id }}">
  <div class="container container-narrow">
    <div class="section-header" data-animate>
      {%- if section.settings.overline != blank -%}
        <p class="overline">{{ section.settings.overline }}</p>
      {%- endif -%}

      <h1 class="heading-xl">{{ section.settings.heading | default: 'Frequently Asked Questions' }}</h1>

      {%- if section.settings.description != blank -%}
        <p>{{ section.settings.description }}</p>
      {%- endif -%}
    </div>

    <div class="faq-list">
      {%- for block in section.blocks -%}
        <div class="faq-item glass-card" data-animate style="animation-delay: {{ forloop.index | times: 50 }}ms;">
          <button class="faq-question" aria-expanded="false">
            <span>{{ block.settings.question }}</span>
            <svg class="faq-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          </button>
          <div class="faq-answer">
            <div class="faq-answer-inner">
              {{ block.settings.answer }}
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>

    {%- if section.settings.cta_text != blank -%}
      <div class="faq-cta text-center mt-xl" data-animate>
        <p class="text-secondary mb-md">{{ section.settings.cta_description | default: "Still have questions?" }}</p>
        <a href="{{ section.settings.cta_link }}" class="btn btn-primary">
          {{ section.settings.cta_text }}
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  .faq-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 3rem;
  }

  .faq-item {
    overflow: hidden;
  }

  .faq-question {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 1.5rem 2rem;
    background: none;
    border: none;
    cursor: pointer;
    text-align: left;
    font-family: var(--font-display);
    font-size: 1.0625rem;
    font-weight: 600;
    color: var(--text-primary);
    transition: color 0.2s ease;
  }

  .faq-question:hover {
    color: var(--accent-primary);
  }

  .faq-icon {
    flex-shrink: 0;
    transition: transform 0.3s ease;
  }

  .faq-item.active .faq-icon {
    transform: rotate(45deg);
  }

  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .faq-item.active .faq-answer {
    max-height: 500px;
  }

  .faq-answer-inner {
    padding: 0 2rem 1.5rem;
    color: var(--text-secondary);
    line-height: 1.7;
  }

  .faq-answer-inner p {
    margin-bottom: 1rem;
  }

  .faq-answer-inner p:last-child {
    margin-bottom: 0;
  }

  .faq-cta {
    margin-top: 4rem;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const faqItems = document.querySelectorAll('.faq-item');

    faqItems.forEach(item => {
      const question = item.querySelector('.faq-question');

      question.addEventListener('click', () => {
        const isActive = item.classList.contains('active');

        // Close all other items
        faqItems.forEach(otherItem => {
          if (otherItem !== item) {
            otherItem.classList.remove('active');
            otherItem.querySelector('.faq-question').setAttribute('aria-expanded', 'false');
          }
        });

        // Toggle current item
        item.classList.toggle('active');
        question.setAttribute('aria-expanded', !isActive);
      });
    });
  });
</script>

{% schema %}
{
  "name": "FAQ",
  "tag": "section",
  "class": "faq-section",
  "settings": [
    {
      "type": "text",
      "id": "overline",
      "label": "Overline Text",
      "default": "Support"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Everything you need to know about Ground."
    },
    {
      "type": "text",
      "id": "cta_description",
      "label": "CTA Description",
      "default": "Still have questions?"
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Text",
      "default": "Contact Us"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "CTA Link"
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "Question",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How does Ground work?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Ground is an NFC device that works with our free iOS app. Simply select the apps you want to block, and they'll stay blocked until you physically tap the Ground device. No bypasses, no workarounds.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "question": "How does Ground work?",
            "answer": "<p>Ground is an NFC device that works with our free iOS app. Simply select the apps you want to block, and they'll stay blocked until you physically tap the Ground device. No bypasses, no workarounds.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "What phones is Ground compatible with?",
            "answer": "<p>Ground works with any iPhone that has NFC capabilities (iPhone 7 and later). We're working on Android support.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "Is there a subscription?",
            "answer": "<p>No! Ground is a one-time purchase. The app is free, and there are no hidden fees or subscriptions.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "What's your return policy?",
            "answer": "<p>We offer a 30-day money back guarantee. If Ground doesn't work for you, just reach out and we'll process a full refund.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
